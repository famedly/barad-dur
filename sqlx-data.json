{
  "db": "PostgreSQL",
  "5188c1c35cc0876ed0127e0a0a775f4a3928172bb85222e40adb44e8e93cf077": {
    "query": "\nINSERT INTO aggregate_stats (\n    day,\n    total_users,\n    total_nonbridged_users,\n    total_room_count,\n    daily_active_users,\n    daily_active_rooms,\n    daily_messages,\n    daily_sent_messages,\n    daily_active_e2ee_rooms,\n    daily_e2ee_messages,\n    daily_sent_e2ee_messages,\n    monthly_active_users,\n    r30_users_all,\n    r30_users_android,\n    r30_users_ios,\n    r30_users_electron,\n    r30_users_web,\n    r30v2_users_all,\n    r30v2_users_android,\n    r30v2_users_ios,\n    r30v2_users_electron,\n    r30v2_users_web,\n    daily_user_type_native,\n    daily_user_type_bridged,\n    daily_user_type_guest,\n    daily_active_homeservers\n)\nSELECT\n    local_timestamp::DATE,\n    SUM(total_users),\n    SUM(total_nonbridged_users),\n    SUM(total_room_count),\n    SUM(daily_active_users),\n    SUM(daily_active_rooms),\n    SUM(daily_messages),\n    SUM(daily_sent_messages),\n    SUM(daily_active_e2ee_rooms),\n    SUM(daily_e2ee_messages),\n    SUM(daily_sent_e2ee_messages),\n    SUM(monthly_active_users),\n    SUM(r30_users_all),\n    SUM(r30_users_android),\n    SUM(r30_users_ios),\n    SUM(r30_users_electron),\n    SUM(r30_users_web),\n    SUM(r30v2_users_all),\n    SUM(r30v2_users_android),\n    SUM(r30v2_users_ios),\n    SUM(r30v2_users_electron),\n    SUM(r30v2_users_web),\n    SUM(daily_user_type_native),\n    SUM(daily_user_type_bridged),\n    SUM(daily_user_type_guest),\n    COUNT(homeserver)\nFROM statsreport WHERE local_timestamp::DATE >= (SELECT COALESCE(MAX(day), 'EPOCH'::DATE) FROM aggregate_stats)\nGROUP BY local_timestamp::DATE\nON CONFLICT (day) \nDO UPDATE SET\n    total_users = excluded.total_users,\n    total_nonbridged_users = excluded.total_nonbridged_users,\n    total_room_count = excluded.total_room_count,\n    daily_active_users = excluded.daily_active_users,\n    daily_active_rooms = excluded.daily_active_rooms,\n    daily_messages = excluded.daily_messages,\n    daily_sent_messages = excluded.daily_sent_messages,\n    daily_active_e2ee_rooms = excluded.daily_active_e2ee_rooms,\n    daily_e2ee_messages = excluded.daily_e2ee_messages,\n    daily_sent_e2ee_messages = excluded.daily_sent_e2ee_messages,\n    monthly_active_users = excluded.monthly_active_users,\n    r30_users_all = excluded.r30_users_all,\n    r30_users_android = excluded.r30_users_android,\n    r30_users_ios = excluded.r30_users_ios,\n    r30_users_electron = excluded.r30_users_electron,\n    r30_users_web = excluded.r30_users_web,\n    r30v2_users_all = excluded.r30_users_all,\n    r30v2_users_android = excluded.r30_users_android,\n    r30v2_users_ios = excluded.r30_users_ios,\n    r30v2_users_electron = excluded.r30_users_electron,\n    r30v2_users_web = excluded.r30_users_web,\n    daily_user_type_native = excluded.daily_user_type_native,\n    daily_user_type_bridged = excluded.daily_user_type_bridged,\n    daily_user_type_guest = excluded.daily_user_type_guest,\n    daily_active_homeservers = excluded.daily_active_homeservers\n        ;",
    "describe": {
      "columns": [],
      "parameters": {
        "Left": []
      },
      "nullable": []
    }
  },
  "b59ea28d546c3e85143cf28c7f87f33366228f7c6851f8d3bc87e91d4c363fae": {
    "query": "\nINSERT INTO statsreport (\n    homeserver,\n    local_timestamp,\n    remote_timestamp,\n    remote_addr,\n    forwarded_for,\n    uptime_seconds,\n    total_users,\n    total_nonbridged_users,\n    total_room_count,\n    daily_active_users,\n    daily_active_rooms,\n    daily_messages,\n    daily_sent_messages,\n    daily_active_e2ee_rooms,\n    daily_e2ee_messages,\n    daily_sent_e2ee_messages,\n    monthly_active_users,\n    r30_users_all,\n    r30_users_android,\n    r30_users_ios,\n    r30_users_electron,\n    r30_users_web,\n    r30v2_users_all,\n    r30v2_users_android,\n    r30v2_users_ios,\n    r30v2_users_electron,\n    r30v2_users_web,\n    cpu_average,\n    memory_rss,\n    cache_factor,\n    event_cache_size,\n    user_agent,\n    daily_user_type_native,\n    daily_user_type_bridged,\n    daily_user_type_guest,\n    python_version,\n    database_engine,\n    database_server_version,\n    server_context,\n    log_level) VALUES ( $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13, $14, $15, $16, $17, $18, $19, $20, $21, $22, $23, $24, $25, $26, $27, $28, $29, $30, $31, $32, $33, $34, $35, $36, $37, $38, $39, $40 )\nRETURNING id;",
    "describe": {
      "columns": [
        {
          "ordinal": 0,
          "name": "id",
          "type_info": "Int8"
        }
      ],
      "parameters": {
        "Left": [
          "Text",
          "Timestamptz",
          "Timestamptz",
          "Text",
          "Text",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Int8",
          "Float8",
          "Int8",
          "Text",
          "Int8",
          "Int8",
          "Int8",
          "Text",
          "Text",
          "Text",
          "Text",
          "Text"
        ]
      },
      "nullable": [
        false
      ]
    }
  }
}